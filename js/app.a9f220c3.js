(function(){"use strict";var e={4233:function(e,t,n){var o=n(9242),r=(n(1827),n(3203)),l=n(7793),i=n(3886),a=n(6525),c=new r.Z({controls:(0,i.c)({rotate:!1,zoom:!1,attribution:!1}),interactions:(0,a.c)({pinchRotate:!1}),view:new l.ZP({center:[0,0],zoom:4,minZoom:4,maxZoom:19})}),s=n(3396);function u(e,t,n,o,r,l){const i=(0,s.up)("Homepage");return(0,s.wg)(),(0,s.j4)(i)}var d=n(7139),f=n(4870),m=n(2567),p=n(3765),w=n(1886),g=n(4109),v=n(1505),h=n(3292),b=n(8406);class y extends b.Z{constructor(e){const t=e||{},n=document.createElement("button"),o=document.createElement("div");o.title=t.title,o.appendChild(n),o.className="ol-zoom-extent-custom ol-unselectable ol-control",super({element:o,target:t.target}),n.addEventListener("click",(()=>{let e=this.getMap().getView();e.animate({center:e.getProperties().defaultCenter,zoom:e.getMinZoom(),duration:250})}))}}class Z extends b.Z{constructor(e){const t=e||{},n=document.createElement("button"),o=document.createElement("div");o.title=t.title,o.appendChild(n),o.className="ol-grid-custom ol-unselectable ol-control",super({element:o,target:t.target}),n.addEventListener("click",(()=>{let e=t.layer;e.getVisible()?e.setVisible(!1):e.setVisible(!0)}))}}class _ extends b.Z{constructor(e){const t=e||{},n=document.createElement("button"),o=document.createElement("div");o.title=t.title,o.appendChild(n),o.className="ol-location-custom ol-unselectable ol-control",super({element:o,target:t.target});let r=t.geolocation;n.addEventListener("click",(()=>{let e=r.getPosition(),t=this.getMap().getView(),n=t.getZoom();void 0!==e&&t.animate({center:e,zoom:n>15?n:15,duration:250})}))}}var k=n(4993);n(1758),n(834),n(4874),n(6009);const C=["multiple","accept"];var P={__name:"index",props:{ifMultiple:Boolean,fileTypes:String},emits:["getFiles"],setup(e,{emit:t}){let n=(0,f.iH)();function r(){n.value.click()}function l(e){let n=e.srcElement.files;t("getFiles",n)}return(t,i)=>((0,s.wg)(),(0,s.iD)("div",{onClick:r},[(0,s.wy)((0,s._)("input",{type:"file",ref_key:"inp",ref:n,multiple:e.ifMultiple,accept:e.fileTypes,onChange:l},null,40,C),[[o.F8,!1]]),(0,s.WI)(t.$slots,"default")]))}};const U=P;var x=U,j=n(9185),S=(n(6229),n(7330),n(2062),n(7918)),F=n.n(S);const V=new(F());function E(e){let t;V.load(e);const n=V.file(/\.kml$/i)[0];return n&&(t=n.asText()),t}function z(e){const t=window.location.href.lastIndexOf("/");if(-1!==t){const n=V.file(e.slice(t+1));if(n)return URL.createObjectURL(new Blob([n.asArrayBuffer()]))}return e}class L extends j.ZP{constructor(e){const t=e||{};t.iconUrlFunction=z,super(t)}getType(){return"arraybuffer"}readFeature(e,t){const n=E(e);return super.readFeature(n,t)}readFeatures(e,t){const n=E(e);return super.readFeatures(n,t)}}var H=n(2548);const O=e=>((0,s.dD)("data-v-1c4859ad"),e=e(),(0,s.Cn)(),e),T={id:"titleBar"},A=O((()=>(0,s._)("span",{class:"el-dropdown-link"},"添加图层",-1))),G=O((()=>(0,s._)("div",{id:"listContent"},[(0,s._)("ul")],-1)));var M={__name:"index",setup(e){const t=(0,f.iH)(".kml,.kmz"),n=(0,s.f3)("olMap");let r=(0,f.iH)(!1);function l(){r.value=!r.value}function i(e){let t=e[0],o=new FileReader;-1!==t.name.search(/\.kml$/i)?(o.readAsText(t),o.onload=function(){let e=o.result,t=new h.Z({format:new j.ZP,loader:function(){this.addFeatures(this.getFormat().readFeatures(e,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"})),n.getView().fit(this.getExtent())}}),r=new H.Z({source:t});n.addLayer(r)}):-1!==t.name.search(/\.kmz$/i)&&(o.readAsArrayBuffer(t),o.onload=function(){let e=o.result,t=new h.Z({format:new L,loader:function(){this.addFeatures(this.getFormat().readFeatures(e,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"})),n.getView().fit(this.getExtent())}}),r=new H.Z({source:t});n.addLayer(r)})}return(e,n)=>{const a=k.Df,c=k.o2,u=k.YK;return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",{class:"ol-layer-custom",title:"图层",onClick:l}),(0,s.wy)((0,s._)("div",{id:"mask",onClick:l},null,512),[[o.F8,(0,f.SU)(r)]]),(0,s._)("div",{id:"LayerPanel",class:(0,d.C_)([(0,f.SU)(r)?"LayerPanel-show":"LayerPanel-hide"])},[(0,s._)("div",T,[(0,s.Wm)(u,{"split-button":""},{dropdown:(0,s.w5)((()=>[(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Wm)(a,null,{default:(0,s.w5)((()=>[(0,s.Wm)((0,f.SU)(x),{fileTypes:t.value,onGetFiles:i},{default:(0,s.w5)((()=>[(0,s.Uk)("本地文件")])),_:1},8,["fileTypes"])])),_:1}),(0,s.Wm)(a,null,{default:(0,s.w5)((()=>[(0,s.Uk)("URL-XYZ")])),_:1})])),_:1})])),default:(0,s.w5)((()=>[(0,s.Wm)((0,f.SU)(x),{fileTypes:t.value,onGetFiles:i},{default:(0,s.w5)((()=>[A])),_:1},8,["fileTypes"])])),_:1})]),G],2)],64)}}},I=n(89);const W=(0,I.Z)(M,[["__scopeId","data-v-1c4859ad"]]);var D=W,B=n(4711),R=n(1673),Y=n(8537),$=n(1317),q=n(1508),N=n(2949),Q=n(9966),J=n(7339),K=n(7712),X=n(2205),ee=n(6241);const te=e=>((0,s.dD)("data-v-75dc8f2e"),e=e(),(0,s.Cn)(),e),ne=te((()=>(0,s._)("div",{id:"map"},null,-1))),oe={id:"panel"},re=te((()=>(0,s._)("br",null,null,-1))),le=te((()=>(0,s._)("br",null,null,-1))),ie=te((()=>(0,s._)("br",null,null,-1))),ae=te((()=>(0,s._)("br",null,null,-1))),ce=te((()=>(0,s._)("br",null,null,-1))),se=te((()=>(0,s._)("div",{id:"crosshair"},null,-1)));var ue={__name:"index",setup(e){const t=(0,s.f3)("olMap");let n=(0,f.iH)(""),o=(0,f.iH)(""),r=(0,f.iH)(""),l=(0,f.iH)(""),i=(0,f.iH)(""),a=(0,f.iH)("");return(0,s.bv)((()=>{let e=new v.Z({key:"Q57tupj2UBsQNQdju4xL~xBceblfTd6icjljunbuaCw~AhwA-whmGMsfIpVhslZyknWhFYq-GvWJZqBnqV8Zq1uRlI5YM_qr7_hxvdgnU7nH",imagerySet:"Aerial"});const c=new p.Z({strokeStyle:new Q.Z({color:"rgba(191,182,182,0.5)",width:2,lineDash:[.5,4]}),showLabels:!0,zIndex:1/0}),s=new w.Z({zIndex:1/0});t.setLayers([s,c,new g.Z({source:e})]),t.addControl(new B.Z({zoomInTipLabel:"放大",zoomOutTipLabel:"缩小"})),t.addControl(new R.Z),t.addControl(new Y.Z({className:"ol-mousePosition-custom",projection:t.getView().getProjection(),placeholder:"未知",coordinateFormat:e=>(0,m.V7)(e)})),t.addControl(new y({title:"复位"})),t.addControl(new Z({title:"经纬网",layer:c}));const u=new $.Z({projection:t.getView().getProjection(),tracking:!0,trackingOptions:{enableHighAccuracy:!0}});let d=new q.Z,f=new J.Z({fill:new K.Z({color:"#3399CC"}),points:3,radius:5,displacement:[0,0],rotation:0,angle:0});d.setStyle([new X.ZP({image:new ee.Z({radius:6,fill:new K.Z({color:"#3399CC"}),stroke:new Q.Z({color:"#fff",width:2})})}),new X.ZP({image:f})]);let b=new q.Z;s.setSource(new h.Z({features:[b,d]})),t.once("loadend",(function(){let e=t.getView(),n=u.getPosition();void 0!==n&&(e.setCenter(n),e.setZoom(15),e.setProperties({defaultCenter:n}))})),u.on("change",(function(){let e=u.getPosition();o.value=(0,m.V7)(e,4);let t=u.getAltitude();l.value=void 0!==t?`${t.toString()}m`:"",d.setGeometry(e?new N.Z(e):void 0)})),u.on("change:accuracyGeometry",(function(){b.setGeometry(u.getAccuracyGeometry()),r.value=`${u.getAccuracy().toString()}m`})),t.getView().on("change:center",(function(){a.value=(0,m.V7)(this.getCenter(),4)})),window.addEventListener("deviceorientationabsolute",(function(e){let t=e.webkitCompassHeading||e.alpha;f.setRotation(Math.PI/180*(360-t)),null===t||!1===e.absolute?(f.setDisplacement([0,0]),i.value=""):(f.setDisplacement([0,10]),i.value=360-t+"°"),d.changed()})),t.addControl(new _({title:"定位",geolocation:u})),t.setTarget("map"),n.value=t.getView().getProjection().getCode(),a.value=(0,m.V7)(t.getView().getCenter(),4)})),(e,t)=>((0,s.wg)(),(0,s.iD)(s.HY,null,[ne,(0,s._)("div",oe,[(0,s.Uk)(" 坐标系："+(0,d.zw)((0,f.SU)(n)),1),re,(0,s.Uk)(" 坐标："+(0,d.zw)((0,f.SU)(o)),1),le,(0,s.Uk)("准心："+(0,d.zw)((0,f.SU)(a)),1),ie,(0,s.Uk)("精度："+(0,d.zw)((0,f.SU)(r)),1),ae,(0,s.Uk)("海拔："+(0,d.zw)((0,f.SU)(l)),1),ce,(0,s.Uk)("方位角："+(0,d.zw)((0,f.SU)(i)),1)]),se,((0,s.wg)(),(0,s.j4)(s.Ob,null,[(0,s.Wm)((0,f.SU)(D))],1024))],64))}};const de=(0,I.Z)(ue,[["__scopeId","data-v-75dc8f2e"]]);var fe=de,me={name:"App",components:{Homepage:fe}};const pe=(0,I.Z)(me,[["render",u]]);var we=pe;const ge=(0,o.ri)(we);ge.provide("olMap",c),ge.mount("#app")}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var l=t[o]={exports:{}};return e[o].call(l.exports,l,l.exports,n),l.exports}n.m=e,function(){var e=[];n.O=function(t,o,r,l){if(!o){var i=1/0;for(u=0;u<e.length;u++){o=e[u][0],r=e[u][1],l=e[u][2];for(var a=!0,c=0;c<o.length;c++)(!1&l||i>=l)&&Object.keys(n.O).every((function(e){return n.O[e](o[c])}))?o.splice(c--,1):(a=!1,l<i&&(i=l));if(a){e.splice(u--,1);var s=r();void 0!==s&&(t=s)}}return t}l=l||0;for(var u=e.length;u>0&&e[u-1][2]>l;u--)e[u]=e[u-1];e[u]=[o,r,l]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var r,l,i=o[0],a=o[1],c=o[2],s=0;if(i.some((function(t){return 0!==e[t]}))){for(r in a)n.o(a,r)&&(n.m[r]=a[r]);if(c)var u=c(n)}for(t&&t(o);s<i.length;s++)l=i[s],n.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return n.O(u)},o=self["webpackChunknavmap"]=self["webpackChunknavmap"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(4233)}));o=n.O(o)})();
//# sourceMappingURL=app.a9f220c3.js.map