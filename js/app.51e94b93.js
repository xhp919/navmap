(function(){"use strict";var e={2346:function(e,t,n){var o=n(9242),r=n(7139),l=(n(1827),n(3203)),a=n(7793),i=n(3886),c=n(6525);const s=new l.Z({controls:(0,i.c)({rotate:!1,zoom:!1,attribution:!1}),interactions:(0,c.c)({pinchRotate:!1}),view:new a.ZP({center:[0,0],zoom:4,minZoom:4,maxZoom:19})});var u={namespaced:!0,state(){return{olMap:s}}},d=(0,r.MT)({modules:{map:u}}),f=n(3396);function m(e,t,n,o,r,l){const a=(0,f.up)("Homepage");return(0,f.wg)(),(0,f.j4)(a)}var p=n(4993);n(1758),n(834),n(4874),n(6009);const g=["multiple","accept"];function w(e,t,n,r,l,a){return(0,f.wg)(),(0,f.iD)("div",{onClick:t[1]||(t[1]=(...e)=>r.openFileSelector&&r.openFileSelector(...e))},[(0,f.wy)((0,f._)("input",{type:"file",ref:"inp",multiple:n.ifMultiple,accept:n.fileTypes,onChange:t[0]||(t[0]=(...e)=>r.inpChange&&r.inpChange(...e))},null,40,g),[[o.F8,!1]]),(0,f.WI)(e.$slots,"default")])}var v=n(4870),h={props:{ifMultiple:Boolean,fileTypes:String},emits:["getFiles"],setup(e,t){let n=(0,v.iH)();function o(){n.value.click()}function r(e){let n=e.srcElement.files;t.emit("getFiles",n)}return{inp:n,openFileSelector:o,inpChange:r}}},b=n(89);const y=(0,b.Z)(h,[["render",w]]);var Z=y,k=n(2268);const C={id:"titleBar"};function F(e,t,n,r,l,a){const i=Z,c=p.Df,s=p.o2,u=p.YK;return(0,f.wg)(),(0,f.iD)(f.HY,null,[(0,f._)("div",{class:"ol-layer-custom",title:"图层",onClick:t[0]||(t[0]=(...e)=>r.toggle&&r.toggle(...e))}),(0,f.wy)((0,f._)("div",{id:"mask",onClick:t[1]||(t[1]=(...e)=>r.toggle&&r.toggle(...e))},null,512),[[o.F8,r.isShow]]),(0,f._)("div",{id:"LayerPanel",class:(0,k.C_)([r.isShow?"LayerPanel-show":"LayerPanel-hide"])},[(0,f._)("div",C,[(0,f.Wm)(u,{"split-button":""},{dropdown:(0,f.w5)((()=>[(0,f.Wm)(s,null,{default:(0,f.w5)((()=>[(0,f.Wm)(c,null,{default:(0,f.w5)((()=>[(0,f.Wm)(i,{fileTypes:".kml,.kmz",onGetFiles:r.getFile},{default:(0,f.w5)((()=>[(0,f.Uk)("本地文件")])),_:1},8,["onGetFiles"])])),_:1}),(0,f.Wm)(c,null,{default:(0,f.w5)((()=>[(0,f.Uk)("URL-XYZ")])),_:1})])),_:1})])),default:(0,f.w5)((()=>[(0,f.Wm)(i,{fileTypes:".kml,.kmz",onGetFiles:r.getFile},{default:(0,f.w5)((()=>[(0,f.Uk)("添加图层")])),_:1},8,["onGetFiles"])])),_:1})])],2)],64)}var P=n(9185),_=(n(6229),n(7330),n(2062),n(7918)),j=n.n(_);const x=new(j());function L(e){let t;x.load(e);const n=x.file(/\.kml$/i)[0];return n&&(t=n.asText()),t}function V(e){const t=window.location.href.lastIndexOf("/");if(-1!==t){const n=x.file(e.slice(t+1));if(n)return URL.createObjectURL(new Blob([n.asArrayBuffer()]))}return e}class E extends P.ZP{constructor(e){const t=e||{};t.iconUrlFunction=V,super(t)}getType(){return"arraybuffer"}readFeature(e,t){const n=L(e);return super.readFeature(n,t)}readFeatures(e,t){const n=L(e);return super.readFeatures(n,t)}}var S=n(2548),z=n(3292),G={name:"LayerPanel",components:{FileSelector:Z},setup(){const e=(0,r.oR)(),t=(0,f.Fl)((()=>e.state.map.olMap)).value;let n=(0,v.iH)(!1);function o(){n.value=!n.value}function l(e){let n=e[0],o=new FileReader;-1!==n.name.search(/\.kml$/i)?(o.readAsText(n),o.onload=function(){let e=o.result,n=new z.Z({format:new P.ZP,loader:function(){let n=this.getFormat().readFeatures(e);for(let e of n)e.getGeometry().transform("EPSG:4326","EPSG:3857");this.addFeatures(n),t.getView().fit(this.getExtent())}}),r=new S.Z({source:n});t.addLayer(r)}):-1!==n.name.search(/\.kmz$/i)&&(o.readAsArrayBuffer(n),o.onload=function(){let e=o.result,n=new z.Z({format:new E,loader:function(){let n=this.getFormat().readFeatures(e);for(let e of n)e.getGeometry().transform("EPSG:4326","EPSG:3857");this.addFeatures(n),t.getView().fit(this.getExtent())}}),r=new S.Z({source:n});t.addLayer(r)})}return{isShow:n,toggle:o,getFile:l}}};const H=(0,b.Z)(G,[["render",F],["__scopeId","data-v-7a458eb2"]]);var O=H;const U=e=>((0,f.dD)("data-v-5fabca99"),e=e(),(0,f.Cn)(),e),T=U((()=>(0,f._)("div",{id:"map"},null,-1))),M={id:"panel"},A=U((()=>(0,f._)("br",null,null,-1))),W=U((()=>(0,f._)("br",null,null,-1))),R=U((()=>(0,f._)("br",null,null,-1))),B=U((()=>(0,f._)("br",null,null,-1))),D=U((()=>(0,f._)("br",null,null,-1))),I=U((()=>(0,f._)("div",{id:"crosshair"},null,-1)));function Y(e,t,n,o,r,l){const a=O;return(0,f.wg)(),(0,f.iD)(f.HY,null,[T,(0,f._)("div",M,[(0,f.Uk)(" 坐标系："+(0,k.zw)(o.proj),1),A,(0,f.Uk)(" 坐标："+(0,k.zw)(o.locationCoord),1),W,(0,f.Uk)("准心："+(0,k.zw)(o.crosshairPoi),1),R,(0,f.Uk)("精度："+(0,k.zw)(o.accuracy),1),B,(0,f.Uk)("海拔："+(0,k.zw)(o.altitude),1),D,(0,f.Uk)("方位角："+(0,k.zw)(o.heading),1)]),I,((0,f.wg)(),(0,f.j4)(f.Ob,null,[(0,f.Wm)(a)],1024))],64)}var $=n(2567),q=n(3765),N=n(1886),Q=n(4109),J=n(1505),K=n(8406);class X extends K.Z{constructor(e){const t=e||{},n=document.createElement("button"),o=document.createElement("div");o.title=t.title,o.appendChild(n),o.className="ol-zoom-extent-custom ol-unselectable ol-control",super({element:o,target:t.target}),n.addEventListener("click",(()=>{let e=this.getMap().getView();e.animate({center:e.getProperties().defaultCenter,zoom:e.getMinZoom(),duration:250})}))}}class ee extends K.Z{constructor(e){const t=e||{},n=document.createElement("button"),o=document.createElement("div");o.title=t.title,o.appendChild(n),o.className="ol-grid-custom ol-unselectable ol-control",super({element:o,target:t.target}),n.addEventListener("click",(()=>{let e=t.layer;e.getVisible()?e.setVisible(!1):e.setVisible(!0)}))}}class te extends K.Z{constructor(e){const t=e||{},n=document.createElement("button"),o=document.createElement("div");o.title=t.title,o.appendChild(n),o.className="ol-location-custom ol-unselectable ol-control",super({element:o,target:t.target});let r=t.geolocation;n.addEventListener("click",(()=>{let e=r.getPosition(),t=this.getMap().getView(),n=t.getZoom();void 0!==e&&t.animate({center:e,zoom:n>15?n:15,duration:3e3})}))}}var ne=n(4711),oe=n(1673),re=n(8537),le=n(1317),ae=n(1508),ie=n(2949),ce=n(9966),se=n(7339),ue=n(7712),de=n(2205),fe=n(6241),me={name:"Homepage",components:{LayerPanel:O},setup(){const e=(0,r.oR)(),t=(0,f.Fl)((()=>e.state.map.olMap)).value;let n=(0,v.iH)(""),o=(0,v.iH)(""),l=(0,v.iH)(""),a=(0,v.iH)(""),i=(0,v.iH)(""),c=(0,v.iH)("");return(0,f.bv)((()=>{let e=new J.Z({key:"Q57tupj2UBsQNQdju4xL~xBceblfTd6icjljunbuaCw~AhwA-whmGMsfIpVhslZyknWhFYq-GvWJZqBnqV8Zq1uRlI5YM_qr7_hxvdgnU7nH",imagerySet:"Aerial"});const r=new q.Z({strokeStyle:new ce.Z({color:"rgba(191,182,182,0.5)",width:2,lineDash:[.5,4]}),showLabels:!0}),s=new N.Z;t.setLayers([new Q.Z({source:e}),r,s]),t.addControl(new ne.Z({zoomInTipLabel:"放大",zoomOutTipLabel:"缩小"})),t.addControl(new oe.Z),t.addControl(new re.Z({className:"ol-mousePosition-custom",projection:t.getView().getProjection(),placeholder:"未知",coordinateFormat:e=>(0,$.V7)(e)})),t.addControl(new X({title:"复位"})),t.addControl(new ee({title:"经纬网",layer:r}));const u=new le.Z({projection:t.getView().getProjection(),tracking:!0,trackingOptions:{enableHighAccuracy:!0}});let d=new ae.Z,f=new se.Z({fill:new ue.Z({color:"#3399CC"}),points:3,radius:5,displacement:[0,0],rotation:0,angle:0});d.setStyle([new de.ZP({image:new fe.Z({radius:6,fill:new ue.Z({color:"#3399CC"}),stroke:new ce.Z({color:"#fff",width:2})})}),new de.ZP({image:f})]);let m=new ae.Z;s.setSource(new z.Z({features:[m,d]})),t.once("loadend",(function(){let e=t.getView(),n=u.getPosition();void 0!==n&&(e.setCenter(n),e.setZoom(15),e.setProperties({defaultCenter:n}))})),u.on("change",(function(){let e=u.getPosition();o.value=(0,$.V7)(e,4);let t=u.getAltitude();a.value=void 0!==t?`${t.toString()}m`:"",d.setGeometry(e?new ie.Z(e):null)})),u.on("change:accuracyGeometry",(function(){m.setGeometry(u.getAccuracyGeometry()),l.value=`${u.getAccuracy().toString()}m`})),t.getView().on("change:center",(function(){c.value=(0,$.V7)(this.getCenter(),4)})),window.addEventListener("deviceorientationabsolute",(function(e){let t=e.webkitCompassHeading||e.alpha;f.setRotation(Math.PI/180*(360-t)),null===t||!1===e.absolute?(f.setDisplacement([0,0]),i.value=""):(f.setDisplacement([0,10]),i.value=360-t+"°"),d.changed()})),t.addControl(new te({title:"定位",geolocation:u})),t.setTarget("map"),n.value=t.getView().getProjection().getCode(),c.value=(0,$.V7)(t.getView().getCenter(),4)})),{proj:n,locationCoord:o,accuracy:l,altitude:a,heading:i,crosshairPoi:c}}};const pe=(0,b.Z)(me,[["render",Y],["__scopeId","data-v-5fabca99"]]);var ge=pe,we={name:"App",components:{Homepage:ge}};const ve=(0,b.Z)(we,[["render",m]]);var he=ve;const be=(0,o.ri)(he);be.use(d),be.mount("#app")}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var l=t[o]={exports:{}};return e[o].call(l.exports,l,l.exports,n),l.exports}n.m=e,function(){var e=[];n.O=function(t,o,r,l){if(!o){var a=1/0;for(u=0;u<e.length;u++){o=e[u][0],r=e[u][1],l=e[u][2];for(var i=!0,c=0;c<o.length;c++)(!1&l||a>=l)&&Object.keys(n.O).every((function(e){return n.O[e](o[c])}))?o.splice(c--,1):(i=!1,l<a&&(a=l));if(i){e.splice(u--,1);var s=r();void 0!==s&&(t=s)}}return t}l=l||0;for(var u=e.length;u>0&&e[u-1][2]>l;u--)e[u]=e[u-1];e[u]=[o,r,l]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var r,l,a=o[0],i=o[1],c=o[2],s=0;if(a.some((function(t){return 0!==e[t]}))){for(r in i)n.o(i,r)&&(n.m[r]=i[r]);if(c)var u=c(n)}for(t&&t(o);s<a.length;s++)l=a[s],n.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return n.O(u)},o=self["webpackChunknavmap"]=self["webpackChunknavmap"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(2346)}));o=n.O(o)})();
//# sourceMappingURL=app.51e94b93.js.map